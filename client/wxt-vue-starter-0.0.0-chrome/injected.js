var injected=function(){"use strict";var A=Object.defineProperty;var G=(T,e,i)=>e in T?A(T,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):T[e]=i;var _=(T,e,i)=>G(T,typeof e!="symbol"?e+"":e,i);function T(n){return n==null||typeof n=="function"?{main:n}:n}var e;(n=>{(t=>{t.INJECT_CONTENT="INJECT_CONTENT",t.BG_POPUP="BG_POPUP"})(n.Channel||(n.Channel={})),(t=>{t.INJECT_CONTENT="INJECT_CONTENT",t.CONTENT_BG="CONTENT_BG",t.BG_POPUP="BG_POPUP"})(n.Port||(n.Port={})),(t=>{t.REQUEST="REQUEST",t.APPROVE="APPROVE",t.EVENT="EVENT"})(n.MessageType||(n.MessageType={})),(t=>{t.INJECTED="INJECTED",t.CONTENT="CONTENT",t.BACKGROUND="BACKGROUND",t.POPUP="POPUP"})(n.MessageFrom||(n.MessageFrom={})),(t=>{t.INJECTED="INJECTED",t.CONTENT="CONTENT",t.BACKGROUND="BACKGROUND",t.POPUP="POPUP"})(n.MessageTo||(n.MessageTo={})),(t=>{t.GET_APPROVE_DATA="GET_APPROVE_DATA",t.GET_APPROVE_DATA_RESPONSE="GET_APPROVE_DATA_RESPONSE",t.APPROVE_RESPONSE="APPROVE_RESPONSE",t.REJECT_RESPONSE="REJECT_RESPONSE",t.REQUEST_ACCOUNTS="REQUEST_ACCOUNTS",t.GET_ACCOUNTS="GET_ACCOUNTS",t.GET_NETWORK="GET_NETWORK",t.SWITCH_NETWORK="SWITCH_NETWORK",t.GET_PUBLIC_KEY="GET_PUBLIC_KEY",t.GET_BALANCE="GET_BALANCE",t.SEND_BITCOIN="SEND_BITCOIN",t.SIGN_MESSAGE="SIGN_MESSAGE",t.SIGN_PSBT="SIGN_PSBT",t.SIGN_PSBTS="SIGN_PSBTS",t.PUSH_TX="PUSH_TX",t.PUSH_PSBT="PUSH_PSBT",t.GET_INSCRIPTIONS="GET_INSCRIPTIONS",t.SEND_INSCRIPTION="SEND_INSCRIPTION"})(n.MessageAction||(n.MessageAction={}))})(e||(e={}));const i=T(()=>{class n{constructor(){_(this,"eventListeners",{});_(this,"on",(s,E)=>{this.eventListeners[s]||(this.eventListeners[s]=[]),this.eventListeners[s].push(E)});_(this,"removeListener",(s,E)=>{this.eventListeners[s]&&(this.eventListeners[s]=this.eventListeners[s].filter(r=>r!==E))});window.addEventListener("message",s=>{const{type:E,data:r,event:S,metadata:c={}}=s.data||{},{to:a}=c;if(a===e.MessageTo.INJECTED&&E===e.MessageType.EVENT&&S){const N=this.eventListeners[S];N&&N.forEach(o=>o(r))}})}send({data:s,type:E,action:r}){return new Promise((S,c)=>{const a=new BroadcastChannel(e.Channel.INJECT_CONTENT),N="msg_"+Date.now(),o=O=>{console.log("Content Script response:",O.data);const{type:I,data:C,error:d,metadata:y={}}=O.data||{},{messageId:u,to:p}=y;![e.MessageType.APPROVE,e.MessageType.REQUEST].includes(I)&&p!==e.MessageTo.INJECTED||u===N&&(C&&S(C),d&&c(new Error(d.message)),a.removeEventListener("message",o),a.close())};a.addEventListener("message",o),window.postMessage({metadata:{origin:window.location.origin,messageId:N,from:e.MessageFrom.INJECTED,to:e.MessageTo.BACKGROUND},type:E,action:r,data:s}),setTimeout(()=>{a.removeEventListener("message",o),a.close(),c(new Error("Content Script response timeout"))},5e6)})}async requestAccounts(){return this.send({type:e.MessageType.APPROVE,action:e.MessageAction.REQUEST_ACCOUNTS})}async getAccounts(){return this.send({type:e.MessageType.REQUEST,action:e.MessageAction.GET_ACCOUNTS})}async getNetwork(){return this.send({type:e.MessageType.REQUEST,action:e.MessageAction.GET_NETWORK})}async switchNetwork(s){return this.send({type:e.MessageType.APPROVE,action:e.MessageAction.SWITCH_NETWORK,data:{network:s}})}async getPublicKey(){return this.send({type:e.MessageType.REQUEST,action:e.MessageAction.GET_PUBLIC_KEY})}async getBalance(){return this.send({type:e.MessageType.REQUEST,action:e.MessageAction.GET_BALANCE})}async sendBitcoin(s,E,r){return this.send({type:e.MessageType.APPROVE,action:e.MessageAction.SEND_BITCOIN,data:{address:s,amount:E,options:r}})}async signMessage(s,E){return this.send({type:e.MessageType.APPROVE,action:e.MessageAction.SIGN_MESSAGE,data:{message:s,type:E}})}async signPsbt(s,E){return this.send({type:e.MessageType.APPROVE,action:e.MessageAction.SIGN_PSBT,data:{psbtHex:s,options:E}})}async signPsbts(s,E){return this.send({type:e.MessageType.APPROVE,action:e.MessageAction.SIGN_PSBTS,data:{psbtHexs:s,options:E}})}async pushTx(s){return this.send({type:e.MessageType.REQUEST,action:e.MessageAction.PUSH_TX,data:{rawtx:s}})}async pushPsbt(s){return this.send({type:e.MessageType.REQUEST,action:e.MessageAction.PUSH_PSBT,data:{psbtHex:s}})}}const t=new n;window.sat20=t});function U(){}function P(n,...t){}const R={debug:(...n)=>P(console.debug,...n),log:(...n)=>P(console.log,...n),warn:(...n)=>P(console.warn,...n),error:(...n)=>P(console.error,...n)};return(async()=>{try{return await i.main()}catch(n){throw R.error('The unlisted script "injected" crashed on startup!',n),n}})()}();
injected;
